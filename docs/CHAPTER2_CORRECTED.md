# 第2章 理論枠組みと数理定義

## 2.1 PPP乖離と二国間距離の定義

まず基本となるPPPの概念と二国間乖離の定式化を行う。購買力平価(PPP)とは「二国の物価水準を等しくする為替レート」と定義される。例えば通貨Aと通貨Bについて、$P_A$を通貨Aの物価水準（例えば消費者物価指数など）、$P_B$を通貨Bの物価水準とすると、絶対的PPPが成立する為替レート$S_{A/B}^{PPP}$（1通貨Aあたりの通貨B単位でのレート）は

$$S_{A/B}^{PPP} = \frac{P_A}{P_B}$$

と表される。実際の名目為替レートを$S_{A/B}^{\text{act}}$とすれば、PPPからの乖離率を対数で表現したもの$d_{A\rightarrow B}$を次式で定義する：

$$d_{A\rightarrow B} \equiv \ln \frac{S_{A/B}^{\text{act}}}{S_{A/B}^{PPP}} = \ln S_{A/B}^{\text{act}} - \ln \frac{P_A}{P_B}.$$

この定義では、$d_{A\rightarrow B} > 0$のとき「実勢レートがPPPよりも通貨A高・B安である」ことを意味し、通貨Bが割安 (undervalued)、通貨Aが割高 (overvalued) であることを示す。一方、$d_{A\rightarrow B} < 0$ならば通貨Bが割高、通貨Aが割安となる。

本研究ではUSD・JPY・TRYの3通貨を分析対象とするため、便宜的にUSDを基軸通貨（通貨A）とし、他のJPY（通貨B）、TRY（通貨C）とのPPP乖離を算出する。すなわち、以下の2つの乖離指標を用いる：

- $d_{USD\rightarrow JPY}$（ドルに対する円のPPP乖離）
- $d_{USD\rightarrow TRY}$（ドルに対するトルコリラのPPP乖離）

---

## 2.2 ミカン定理：3通貨のゼロサム関係

ミカン定理とは、3通貨の相対価値指標$m[i]$がゼロサムの保存則に従うという命題である。言い換えると、3つの$m[i]$の総和は常に0となる。この命題を満たすため、$m[i]$を二国間乖離$d$から次のように定義する：

$$
\begin{pmatrix}
m[\text{USD}] \\
m[\text{JPY}] \\
m[\text{TRY}]
\end{pmatrix}
\equiv
\begin{pmatrix}
\frac{d_{USD\rightarrow JPY} + d_{USD\rightarrow TRY}}{3} \\
\frac{-2\,d_{USD\rightarrow JPY} + d_{USD\rightarrow TRY}}{3} \\
\frac{d_{USD\rightarrow JPY} - 2\,d_{USD\rightarrow TRY}}{3}
\end{pmatrix}. \tag{1}
$$

この定義によって$m[\text{USD}] + m[\text{JPY}] + m[\text{TRY}] = 0$が厳密に保証される（実際に式(1)の右辺を足し合わせれば分子が$(d_{UJ}+d_{UT}) + (-2d_{UJ}+d_{UT}) + (d_{UJ}-2d_{UT}) = 0$となる）。ここで添字を簡略化するため$d_{UJ} \equiv d_{USD\rightarrow JPY}$、$d_{UT} \equiv d_{USD\rightarrow TRY}$と表記した。

式(1)で定義される$m[i]$は、それぞれUSD、JPY、TRYに対応するミスプライシング指標であり、**負の値**はその通貨がバスケット内で相対的に**割安**（低く評価されている）ことを、**正の値**は**割高**（高く評価されている）ことを示す。

例えば$m[\text{JPY}] < 0$ならJPYはバスケット内で他通貨より低く評価されている（他通貨と比べ価値が下がりすぎている）ことを意味し、逆に$m[\text{JPY}] > 0$ならJPYは相対的に高く評価され過ぎていることを意味する。

重要なのは、これら3つの指標が常に足し合わせてゼロになるため、一つの通貨の過大評価は他の通貨の過小評価と必ず釣り合う点である。これは**「三通貨間の力学的バランス」**とも言える性質であり、まさにミカンの房を互いに押し合って輪を成しているような状態と捉えられる。

---

## 2.3 差分関係と二国間PPP乖離の対応

定義(1)が直感的に理解しやすいよう、$d$との関係から解釈する。両辺の差を取ると以下が成り立つ：

$$m[\text{USD}] - m[\text{JPY}] = \frac{(d_{UJ}+d_{UT})}{3} - \frac{(-2d_{UJ} + d_{UT})}{3} = d_{UJ},$$

$$m[\text{USD}] - m[\text{TRY}] = \frac{(d_{UJ}+d_{UT})}{3} - \frac{(d_{UJ} - 2d_{UT})}{3} = d_{UT},$$

$$m[\text{JPY}] - m[\text{TRY}] = \frac{(-2d_{UJ} + d_{UT})}{3} - \frac{(d_{UJ} - 2d_{UT})}{3} = d_{UT} - d_{UJ}.$$

すなわち、本モデルの指標$m[i]$は以下の差分関係を満たす：

- $m[\text{USD}] - m[\text{JPY}] = d_{USD\rightarrow JPY}$
- $m[\text{USD}] - m[\text{TRY}] = d_{USD\rightarrow TRY}$
- $m[\text{JPY}] - m[\text{TRY}] = d_{USD\rightarrow TRY} - d_{USD\rightarrow JPY}$ （これはJPY対TRYの直接的なPPP乖離に等しい）

または等価的に：

- $m[\text{JPY}] - m[\text{USD}] = -d_{USD\rightarrow JPY}$
- $m[\text{TRY}] - m[\text{USD}] = -d_{USD\rightarrow TRY}$

このように、各$m[i]$の差は対応する二国間PPP乖離$d$に一致している（または符号を反転したものに一致する）。

例えば$m[\text{USD}] - m[\text{JPY}] = d_{USD\rightarrow JPY}$であるから、$d_{USD\rightarrow JPY}$が正なら$m[\text{USD}] > m[\text{JPY}]$、すなわちUSDの方がJPYより**割高**となる（円安・ドル高）ことが$m$指標にも反映されている。

一方で$m[\text{USD}]$の増加（割高方向への変化）は他の通貨の$m$の減少（割安方向への変化）を招くため、3通貨全体でミスプライシングの総量が保存されていることになる。これは特にトルコリラの大幅な変動時に、ドルと円が逆方向の調整を余儀なくされ、三者のバランスを保っていたことを示唆する。

---

## 2.4 clr変換とCoDAとの接続

上記の$m[i]$の定義(1)は、中心化対数比変換 (clr変換) の文脈で理解することもできる。clr変換とは、正の要素からなるベクトル（組成：composition）の各成分を幾何平均で割った値の対数を取る操作であり、変換後のベクトルは和が零になる性質を持つ。

一般に組成$x=(x_1,x_2,\dots,x_D)$に対し、$g(x) = (x_1 x_2 \cdots x_D)^{1/D}$を幾何平均とすると、clr変換は

$$\mathrm{clr}(x)_i = \ln \frac{x_i}{g(x)}$$

と定義される。ここで$\sum_{i=1}^D \ln\frac{x_i}{g(x)} = \ln \frac{x_1 x_2 \cdots x_D}{(x_1 x_2 \cdots x_D)} = 0$となるため、出力は和が必ず0になる。これはAitchisonが提唱したコンポジショナルデータ解析 (Compositional Data Analysis, CoDA) における基本的手法であり、比率データを適切に扱うための幾何学的枠組みを提供する。

本研究の3通貨モデルにclr変換を適用してみよう。USDを基軸としたPPP乖離に対応する過小評価度合いの尺度として、各通貨$i$について$K_i = \frac{S_{USD/i}^{\text{act}}}{S_{USD/i}^{PPP}}$と定義する。$K_i$は「通貨$i$がドルに対してどれだけ実勢レートで安いか」の倍率を示し、$K_i > 1$なら通貨$i$は対ドルで割安、$K_i < 1$なら割高である。実際$\ln K_i = d_{USD\rightarrow i}$であり、$K_i$はPPP乖離の指数表示に等しい。

ここで$x=(K_{USD}, K_{JPY}, K_{TRY})$とおくと、clr変換$\mathrm{clr}(x)$は各成分について

$$\mathrm{clr}(x)_i = \ln K_i - \frac{1}{3}(\ln K_{USD} + \ln K_{JPY} + \ln K_{TRY})$$

となる。$\ln K_{USD} = d_{USD\rightarrow USD} = 0$（ドル自身との乖離は0）だから、上式を計算すると$m[i]$の定義(1)の符号を反転したものとなる。すなわち、

$$m[i] = -\mathrm{clr}(K_{USD}, K_{JPY}, K_{TRY})_i$$

この結果は本モデルがCoDAの枠組みに則って構築されていることを示している。すなわち、各通貨の「価値（過小評価度合い）$K_i$の組成」をclr変換することでゼロサムの$m[i]$を得ているのである。Aitchison幾何学において組成は単純形 (simplex) 上の点として表現され、clr変換空間ではそれがユークリッド空間に射影される。したがって$m[i]$ベクトルは本質的に「PPP乖離組成」のユークリッド空間表現とみなせる。

このとき、ミカン定理が示すゼロサム関係はclr空間における線形従属（和が零）という形で保証されている。また差分関係が二国間乖離に一致することは、clr空間での差が対数比に対応することを意味する。

以上より、本モデルはPPP理論をコンポジショナルデータの文脈で再定式化したものと言え、従来の為替分析にCoDAとclr変換の知見を接続する新しいアプローチである。本手法により、3通貨間の相対的なポジショニングが一目で分かる指標系が得られ、次章以降ではその実データへの適用と分析結果を示す。

---

## 2.5 PPPデータソースの選択とMCIへの不変性

### 2.5.1 問題の所在

PPPデータは複数のソースから取得可能である：

- IMF WEO（Implied PPP conversion rate）
- World Bank WDI（PA.NUS.PPP）
- OECD PPP Programme

これらのソース間には1〜2%程度の系統的な差異が存在する。本節では、この差異がMCIの解釈に与える影響を数理的に検討する。

### 2.5.2 ゼロサム構造による吸収

MCIの核心的性質として、以下のゼロサム制約がある：

$$m[\text{USD}] + m[\text{JPY}] + m[\text{TRY}] = 0$$

この制約により、PPP基準値の「レベル」が全体的にシフトしても、バスケット内の相対位置関係は保存される。

具体的に、バスケット内の相対位置（例：TRY対JPY）を検討する：

$$m[\text{TRY}] - m[\text{JPY}] = \frac{(d_{UJ} - 2d_{UT})}{3} - \frac{(-2d_{UJ} + d_{UT})}{3} = d_{UJ} - d_{UT}$$

この相対位置は、PPPの絶対水準ではなく、**二国間乖離率の差**によってのみ決定される。

### 2.5.3 データソース差異の影響分析

**ケース1：共通方向の小幅ズレ（現実的シナリオ）**

全通貨のPPPが同方向に$\epsilon$（1〜2%程度）シフトした場合を考える。

$$\text{PPP}'_i = \text{PPP}_i \cdot (1 + \epsilon)$$

このとき乖離率は：

$$d'_{A \rightarrow i} = \ln\frac{S}{\text{PPP}'_i} = \ln\frac{S}{\text{PPP}_i} - \ln(1+\epsilon) = d_{A \rightarrow i} - \epsilon'$$

各$m[i]$は影響を受けるが、バスケット内の相対位置$m[i] - m[j]$は$d$の差で決まるため、共通項$\epsilon'$は相殺される。

**ケース2：通貨別バラバラな大幅ズレ（仮定的シナリオ）**

通貨ごとに異なる方向へ5〜10%ズレる場合、相対位置関係は崩れ、MCIの解釈に影響が生じる。

### 2.5.4 実務上の含意

現実のデータソース間差異（1〜2%、共通方向）は、MCIの解釈において無視できる水準である。

重要なのは：

1. **一貫性**：同一ソースを時系列で使い続けること
2. **変化の観測**：絶対水準より時系列変化を重視すること

MCIの「0」は絶対的な数値ではなく**均衡状態**を表す概念であり、基準点の微小なシフトはゼロサム構造により吸収される。これはMCIが「値」ではなく「状態」を測定する指標であることの数理的表現である。
